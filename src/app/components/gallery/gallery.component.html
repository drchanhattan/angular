<mat-sidenav-container>
  <mat-sidenav
    #drawer
    mode="over"
    position="end"
    class="mt-16 !rounded-none backdrop-blur"
    [autoFocus]="false"
    [fixedInViewport]="true">
    <!-- Country Picker -->
    <app-country-picker [photos]="photos" (selected)="drawer.close()"></app-country-picker>
  </mat-sidenav>

  <mat-sidenav-content class="!overflow-hidden">
    <!-- Content -->
    @if (!countriesService.isSelected) {
      <ng-container [ngTemplateOutlet]="heroImage"></ng-container>
      <ng-container [ngTemplateOutlet]="countryIcons"></ng-container>
      <ng-container [ngTemplateOutlet]="continent"></ng-container>
    } @else {
      <ng-container [ngTemplateOutlet]="photoGrid"></ng-container>
    }

    <!-- Footer -->
    <app-footer></app-footer>
  </mat-sidenav-content>
</mat-sidenav-container>

<!-- Photo Grid -->
<ng-template #photoGrid>
  @if (photos && countriesService.index !== undefined) {
    <div
      class="fixed left-1/2 top-16 z-10 flex min-w-32 -translate-x-1/2 transform justify-center rounded-b-2xl bg-mat-black/85 backdrop-blur-sm">
      <span class="mx-4 my-2 text-sm font-medium text-mat-yellow">{{ photos[countriesService.index].header }}</span>
    </div>

    <div
      class="mx-auto min-h-screen columns-1 gap-16 overflow-hidden bg-neutral-white px-4 pb-10 pt-28 sm:px-20 lg:columns-3 lg:gap-8">
      @for (url of photos[countriesService.index].urls; track $index) {
        <div class="mat-elevation-z1 mb-16 overflow-hidden rounded-lg lg:mb-8">
          <img
            class="!scale-110 !duration-1000 hover:!scale-100"
            data-src="{{ url }}"
            data-aos="fade-up"
            data-aos-once="true"
            loading="lazy"
            (load)="animate()" />
        </div>
      }
    </div>
  }
</ng-template>

<!-- Hero -->
<ng-template #heroImage>
  <img class="absolute h-screen w-screen animate-zoom object-cover" [src]="hero" />
</ng-template>

<!-- Country Icons -->
<ng-template #countryIcons>
  <div
    class="absolute left-1/2 top-16 hidden w-fit -translate-x-1/2 transform flex-row items-center justify-center rounded-b-3xl bg-mat-black/85 px-4 py-2 backdrop-blur-sm sm:flex">
    @for (photo of photos; track $index; let index = $index) {
      @for (icon of photo.icons; track $index) {
        <app-icon-button
          [routerLink]="index.toString()"
          (click)="countriesService.select(index)"
          class="mx-4 scale-125 hover:scale-150"
          classes="rounded-full"
          [icon]="{ svgIcon: icon }"></app-icon-button>
      }
    }
  </div>
</ng-template>

<!-- Continent Label -->
<ng-template #continent>
  <div class="flex h-screen w-full items-end justify-center">
    <span
      class="w-full bg-gradient-to-b from-transparent to-mat-black/25 pb-40 pt-10 text-center font-ink text-7xl font-semibold text-mat-yellow drop-shadow sm:text-9xl sm:font-medium">
      {{ name }}
    </span>
  </div>
</ng-template>
